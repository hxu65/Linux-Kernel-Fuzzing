diff --git a/pngrutil.c b/pngrutil.c
index fafe78f04..65d12de03 100644
--- a/pngrutil.c
+++ b/pngrutil.c
@@ -277,7 +277,7 @@ png_crc_error(png_structrp png_ptr)
    if (need_crc != 0)
    {
       crc = png_get_uint_32(crc_bytes);
-      return ((int)(crc != png_ptr->crc));
+      return (0);
    }
 
    else
@@ -3169,6 +3169,8 @@ png_check_chunk_length(png_const_structrp png_ptr, const png_uint_32 length)
       size_t row_factor =
          (png_ptr->width * png_ptr->channels * (png_ptr->bit_depth > 8? 2: 1)
           + 1 + (png_ptr->interlaced? 6: 0));
+
+      AIF_RANGE(0,row_factor,0,0);
       if (png_ptr->height > PNG_UINT_32_MAX/row_factor)
          idat_limit=PNG_UINT_31_MAX;
       else
